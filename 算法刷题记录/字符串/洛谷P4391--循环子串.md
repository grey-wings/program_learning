[题目链接](https://www.luogu.com.cn/problem/P4391)  

[参考链接](https://www.codeleading.com/article/86882163737/)  
#  一、定理  
对于长度为```len```的字符串s，如果它有最小循环节，那么最小循环节的长度```c_l = len - next[len]```，c_l代表cycle len  
如果s可以由完全循环节组成，那么```len % c_l == 0``` ，当然，循环周期还需要大于1  

# 二、讲解和证明  
## 1.举例  
### (1)  
len = 6, next[6] = 3  
则说明s[0 ~ 2] = s[3 ~ 5]相等（这里的区间全闭）  
这里c_l = 6 - 3 = 3，len % c_l == 0，说明s可以由循环节组成  
循环节为s[0 ~ 2]  

### (2)  
len = 8，next[8] = 6  
c_l = len - next[8] = 2  
则：s[0]s[1]s[2]s[3]s[4]s[5] == s[2]s[3]s[4]s[5]s[6]s[7]  
一一对应，就可以得到s[0]s[1] == s[2]s[3], s[2]s[3] == s[4]s[5], s[4]s[5] == s[6]s[7]  
即循环节长度为2  

## 2.理论解释  
对于一个字符串abcdabcdabcd，由长度为4的子串abcd循环3次组成，则必有前8位等于后8位  
同理，对于某个字符串S，长度为len，由长度为L的字符串s重复R次得到，当R≥2时必然有S[0..len-L-1]=S[L..len-1]，字符串下标从0开始  
这时有next[len] = len - L，这里的L一定是最小的，因为next求出的前后缀相等的长度是最大的  

## 3.证明  
![image](https://user-images.githubusercontent.com/74122331/136538139-0c69e8ef-251e-4f3a-aef9-5e3cb5fa5fd7.png)
用一个图来说明问题。假设一整条线段表示一个字符串s，用彩色标出的部分表示最长相等前后缀，金色部分表示去掉最长相等后缀之后剩下的那一段，长度是c_L.  
把字符串分成长度都为c_L的子串。由于字符串上下同一位置对应相等，彩色部分的每一段对应相等，因此有：  
第1段等于金色部分，也等于第2段；  
第3段等于第2段，也等于第4段；  
第5段等于第4段，也等于第6段；......  
因此，每个有标号的数字段都相等，它们和金色部分也相等，即金色部分是最小循环节。  
