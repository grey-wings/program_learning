# 矩阵树定理  
解决一个图的生成树个数问题  
所有涉及的图允许重边不允许自环
## 1.无向图情况     
设G为一个有n个顶点的无向图，定义度数矩阵D(G)为：  
Dii(G) = deg(i), Dij = 0, i != j
设\#e(i, j)为点i与点j相邻的边数，并定义邻接矩阵A为：  
Aij(G) = Aji(G) = \#e(i, j), i != j  
定义Laplace矩阵L为：  
L(G) = D(G) - A(G)  
记图G的所有生成树个数为t(G)  
## 2.有向图情况      
定义出度矩阵Dout(G)为：
Dout(G)[i, i] = deg(out)[i], Dout(G)[i, j] = 0, i != j  
入度矩阵Din(G)定义同  
设\#e(i, j)为点i指向点j的有向边数，并定义邻接矩阵A  
出度Laplace矩阵，入度Laplace矩阵定义为D-A  
记图G的以r为根的所有根向树形图个数为Troot(G, r)。所谓根向树形图，是说这张图的基图是一棵树，所有的边全部指向父亲。   
记图G的以r为根的所有叶向树形图个数为Tleaf(G, r)。所谓叶向树形图，是说这张图的基图是一棵树，所有的边全部指向儿子。
## 3.定理内容  
### 定理 1（矩阵树定理，无向图行列式形式）
对于任意的i，都有
![](https://i.postimg.cc/Qd7TWnkw/QQ-20220412140818.jpg)  
其中记号![](https://i.postimg.cc/nrQHwNzt/QQ-20220412140818.jpg)表示矩阵L的第1, 2, ... i - 1, i + 1, ... n行与第1, 2, ... i - 1, i + 1, ... n列构成的子矩阵。  
也就是说，无向图的 Laplace 矩阵具有这样的性质，它的所有n - 1阶主子式都相等。  
### 定理 2（矩阵树定理，无向图特征值形式） 
设![](https://i.postimg.cc/g2GxnkjX/QQ-20220412140818.jpg)为L(G)的n - 1个非零特征值，那么有   
![](https://i.postimg.cc/NfkMqqDg/QQ-20220412140818.jpg)  
### 定理 3（矩阵树定理，有向图根向形式）  
对于任意的k，都有  
![](https://i.postimg.cc/yYLHyVnS/QQ-20220412140818.jpg)  
因此如果要统计一张图所有的根向树形图，只要枚举所有的根k并对Troot(G, k)求和即可。    
### 定理 4（矩阵树定理，有向图叶向形式）   
![](https://i.postimg.cc/2yCsnJZw/QQ-20220412140818.jpg)   
因此如果要统计一张图所有的叶向树形图，只要枚举所有的根k并对Tleaf(G, k)求和即可。  
### 定理 5 (BEST 定理）  
设G是有向欧拉图，那么G的不同欧拉回路总数ec(G)是  
![](https://i.postimg.cc/8P0YCstw/QQ-20220412140818.jpg)  
注意，对欧拉图G的任意两个节点k和k'，都有Troot(G, k) = Troot(G, k')，且欧拉图G的所有节点的入度和出度相等。

